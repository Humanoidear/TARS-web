---
import { contentfulClient } from "../lib/contentful";
import type { work } from "../lib/contentful";
import Button from "./Button.astro";

let currentYear = new Date().getFullYear();

const entries = await contentfulClient.getEntries<work>({
  content_type: "blogTars",
});
const posts = entries.items.map((item) => {
  const { title, slug, date, headerImg, description } = item.fields;
  return {
    title,
    slug,
    date,
    headerImg,
    description,
  };
});
---

<div
  class="py-12 mt-28 px-6 md:px-36 w-screen bg-gradient-to-tr from-[#1c1832] to-[#481b72] text-white flex flex-col lg:flex-row gap-16 md:gap-6 md:items-center md:justify-between z-50 relative"
>
  <span class="flex flex-col gap-3 z-10">
    <span>
      <span class="flex flex-row items-center gap-6">
        <span class="flex flex-row items-center gap-3">
          <img src="/img/logo-isotype.png" id="isotype" class="w-14 h-14" />
          <img src="/img/logo-wordmark.png" id="wordmark" class="h-6 w-28" />
        </span>
        <div class="w-[2px] h-10 bg-white/30"></div>
        <img
          src="/img/logo-geupv.png"
          alt="Logo Generación Espontánea UPV"
          class="h-16 invert brightness-200"
        />
      </span>
      <h3 class="mt-3 font-medium text-xl">
        Innovación y excelencia en robótica competitiva
      </h3>
    </span>
    <span class="flex flex-row gap-3">
      <Button icon="/img/user.svg" href="/about" text="Únete" white />
          <Button 
        icon="/img/money.svg" 
        href="mailto:contacto@tarsupv.com?subject=Patrocinio" 
        text="Patrocinar" 
      />
    </span>
    <p class="mt-6">
      &copy; {currentYear} TARS UPV. Todos los derechos reservados.
    </p>
    <div class="invert flex flex-row items-center gap-6">
      <a
        href="https://x.com/Tars_UPV"
        target="_blank"
        rel="noopener noreferrer"
        class="opacity-60 hover:opacity-100"
      >
        <img src="/img/twitter.svg" alt="Twitter" class="w-6 h-6" />
      </a>
      <a
        href="https://www.linkedin.com/company/105258034/admin/dashboard/"
        target="_blank"
        rel="noopener noreferrer"
        class="opacity-60 hover:opacity-100"
      >
        <img src="/img/linkedin.svg" alt="Facebook" class="w-8 h-8" />
      </a>
      <a
        href="https://www.instagram.com/tars.upv"
        target="_blank"
        rel="noopener noreferrer"
        class="opacity-60 hover:opacity-100"
      >
        <img src="/img/instagram.svg" alt="Instagram" class="w-6 h-6" />
      </a>
      <a
        href="https://www.youtube.com/@TARSupv?sub_confirmation=1"
        target="_blank"
        rel="noopener noreferrer"
        class="opacity-60 hover:opacity-100"
      >
        <img src="/img/youtube.svg" alt="YouTube" class="w-6 h-6" />
      </a>
    </div>
  </span>

  <span class="hidden lg:flex flex-row gap-6 z-50">
    <div class="max-w-[500px] flex flex-col gap-3">
      <h2 class="md:text-right font-extrabold text-2xl">
        Últimas publicaciones
      </h2>
      {
        posts.slice(0, 2).map((post) => (
          <a href={`/work/${post.slug}`} class="hover:text-[#883aeb]">
            <h3 class="md:text-right font-medium text-xl">{post.title}</h3>
            <p class="md:text-right text-white/60 line-clamp-2">
              {post.description}
            </p>
          </a>
        ))
      }
      <a
        href="/work"
        class="mt-3 text-right text-white/60 hover:text-[#9264ce] text-underline flex flex-row items-center md:justify-end gap-1"
        >Ver más <svg
          class="w-6 h-6"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 24 24"
        >
          <path
            d="M8 5v2h2V5H8zm4 4V7h-2v2h2zm2 2V9h-2v2h2zm0 2h2v-2h-2v2zm-2 2v-2h2v2h-2zm0 0h-2v2h2v-2zm-4 4v-2h2v2H8z"
            fill="currentColor"></path>
        </svg></a
      >
    </div>
  </span>

  <div class="scrolling-text-container">
    <div class="scrolling-text">
      Innovación y excelencia en robótica competitiva
    </div>
    <div class="scrolling-text ml-20">
      Innovación y excelencia en robótica competitiva
    </div>
  </div>
</div>

<style>
  .scrolling-text-container {
    top: 0;
    left: 0;
    width: 100%;
    background: #1a1a1a30;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
    z-index: 0;
    position: absolute;
  }

  .scrolling-text {
    font-size: 20rem;
    font-weight: bolder;
    font-family: "SourceCodePro", monospace;
    color: transparent;
    -webkit-text-stroke: 5px rgba(255, 255, 255, 0.03);
    white-space: nowrap;
    display: inline-block;
    animation: scroll 300s linear infinite;
  }

  @keyframes scroll {
    0% {
      transform: translateX(100%);
    }
    100% {
      transform: translateX(-100%);
    }
  }
</style>
