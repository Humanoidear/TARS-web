---
import { contentfulClient } from "../lib/contentful";
import type { work } from "../lib/contentful";
import Layout from "../layouts/Layout.astro";
import Button from "../components/Button.astro";
import Header from "../components/Header.astro";
import Footer from "../components/Footer.astro";
import TeamJson from "../components/team.astro";

const entries = await contentfulClient.getEntries<work>({
  content_type: "blogTars",
});
const posts = entries.items.map((item) => {
  const { title, slug, date, headerImg, description } = item.fields;
  return {
    title,
    slug,
    date,
    headerImg,
    description
  };
});

const competitions = [
  {
    image:
      "https://www.spaceagenda.com/wp-content/uploads/2024/07/erc-featured-min-1024x597-1.webp",
    title: "ERC",
    description:
      "European Rover Challenge (ERC) es una competici\u00F3n internacional de rob\u00F3tica espacial donde equipos de todo el mundo dise\u00F1an y construyen rovers para realizar misiones en un entorno simulado de Marte.",
  },
  {
    image:
      "https://www.eurobot.es/wp-content/uploads/2024/02/Eurobot2024_Cartel-724x1024.png",
    title: "Eurobot",
    description:
      "Eurobot es una competici\u00F3n internacional de rob\u00F3tica donde equipos de estudiantes y aficionados dise\u00F1an, construyen y programan robots aut\u00F3nomos para completar desaf\u00EDos espec\u00EDficos en un campo de juego.",
  },
  {
    image:
      "https://thumbs.dreamstime.com/b/uav-drone-modern-cityscape-communication-network-concept-telecommunication-smart-city-iot-ict-g-ai-generated-uav-drone-318726787.jpg",
    title: "Drone Inteligente",
    description:
      "La competici\u00F3n de Drone Inteligente desaf\u00EDa a los equipos a desarrollar drones aut\u00F3nomos capaces de realizar tareas complejas, como navegaci\u00F3n, reconocimiento y manipulaci\u00F3n de objetos en entornos din\u00E1micos.",
  },
  {
    image: "https://battlebots.com/wp-content/uploads/2023/11/IMG_9072.jpg",
    title: "Battlebots",
    description:
      "Battlebots es una competici\u00F3n de rob\u00F3tica donde equipos dise\u00F1an y construyen robots de combate que se enfrentan en una arena, utilizando diversas armas y estrategias para derrotar a sus oponentes.",
  },
];
---

<Layout title="TARS | Innovación y excelencia en robótica competitiva">
  <Header />
  <main>
    <div
      class="top-0 w-screen h-screen rounded-b-lg flex flex-row items-center px-48 relative"
    >
      <div class="flex flex-col items-start gap-3 z-20 relative">
        <h1 class="mb-0 text-7xl text-white flex flex-col items-start">
          <span class="opacity-60 text-2xl font-[SourceCodePro] font-medium"
            >somos_</span
          ><img src="/img/logo-wordmark.png" class="mt-3 h-16" />
        </h1>
        <p class="mb-6 max-w-[450px] text-2xl text-white/60 font-medium">
          Innovación y excelencia en robótica competitiva
        </p>
        <Button text="Descubre nuestro proyectos" href="/#about" />
      </div>
      <span
        class="parallax-text bottom-32 -left-[10%] font-[Braille] text-[200px] text-white opacity-5 rotate-90 z-0 absolute"
        >TARS</span
      >
      <iframe
        src="/html/particles.html"
        class="top-0 left-0 opacity-60 w-screen h-screen absolute"></iframe>
      <div
        class="left-0 top-0 hero w-screen h-screen min-h-[800px] z-10 absolute"
      >
      </div>
      <div class="left-0 top-0 bg w-screen h-screen min-h-[800px] z-0 absolute">
      </div>
    </div>
    <div class="w-screen bg-[#121212]">
      <div class="flex flex-row gap-6 px-36 relative">
        {
          posts.map((post, i) => (
            <a href={`work/${post.slug}`} class="post w-1/4 rounded-lg bg-[#181818] -translate-y-16 hover:-translate-y-20 hover:shadow-md transition-all overflow-hidden">
              <img
                src={post.headerImg?.fields?.file?.url}
                alt={`Noticia ${i + 1}`}
                class="w-full h-56 top-0 left-0 object-cover"
              />
              <div class="p-3">
                <h2 class="font-bold text-2xl text-white">{post.title}</h2>
                <p class="mb-3 text-white">
                  {post.description ||
                    "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla nec dui nec odio."}
                </p>
              </div>
              <div class="more">
                <div class="w-full h-16 bg-white/5 hover:bg-white/10 text-white text-xl font-semibold flex items-center justify-center transition-all">
                  Leer más
                  </div>
                </div>
            </a>
          ))
        }
        {
          Array.from({ length: 4 - posts.length }).map((_, i) => (
            <div class="w-1/4 rounded-lg bg-[#181818] -translate-y-16 hover:-translate-y-20 hover:shadow-md transition-all overflow-hidden">
              <div class="w-full h-56 top-0 left-0 object-cover bg-[#181818]" />
              <div class="p-3">
                <h2 class="font-bold text-2xl text-transparent">Placeholder</h2>
                <p class="mb-3 text-transparent">Placeholder description</p>
                <div class="mb-6" />
              </div>
            </div>
          ))
        }
      </div>
      <h3
        class="px-36 -translate-y-12 font-[SourceCodePro] text-white/70 text-xl"
      >
        Últimas noticias_
      </h3>
      <div id="about" class="mt-16 px-36 flex flex-row gap-8 items-center">
        <div class="max-w-[800px]">
          <h2 class="font-bold text-4xl text-white">Sobre nosotros</h2>
          <p class="mt-3 mb-6 text-white">
            En TARS UPV, somos apasionados por la robótica y la tecnología. Como
            grupo universitario de la Universidad Politécnica de Valencia, nos
            dedicamos a diseñar, construir y programar robots para competir en
            eventos nacionales e internacionales. Nuestro objetivo es fomentar
            el aprendizaje y la innovación en el campo de la robótica,
            proporcionando a nuestros miembros la oportunidad de desarrollar
            habilidades técnicas y de trabajo en equipo.
          </p>
          <Button text="Conoce al equipo" href="/#team" />
        </div>
        <div class="rover-image w-full h-auto transition-all relative">
          <img
            src="https://www.tarsupv.com/images/robot.jpg"
            alt="Robot"
            class="w-full h-auto rounded-lg bg-[#181818]"
          />
          <div
            class="bg-tilt top-0 w-full h-full rounded-lg rotate-6 bg-[#18181830] transition-all absolute"
          >
          </div>
        </div>
      </div>
      <div class="px-36 mt-36">
        <div
          class="mb-6 w-full flex flex-row items-center justify-between gap-6"
        >
          <h2 class="font-bold text-4xl text-white">Nuestros proyectos</h2>
        </div>
        <div
          class="w-full h-auto bg-[#121212] grid grid-cols-1 md:grid-cols-2 gap-6"
        >
          {
            competitions.map((competition) => (
              <div class="card">
                <div class="card-inner rounded-lg bg-[#181818] hover:shadow-lg overflow-hidden">
                  <img
                    src={competition.image}
                    alt={competition.title}
                    class="w-full h-56 top-0 left-0 object-cover"
                  />
                  <div class="p-4">
                    <h2 class="text-xl font-semibold text-white mb-2">
                      {competition.title}
                    </h2>
                    <p class="text-gray-400">{competition.description}</p>
                  </div>
                </div>
                <div class="hover-effect absolute inset-0 -top-full -left-full pointer-events-none" />
              </div>
            ))
          }
        </div>

        <script is:inline>
          document.querySelectorAll(".card").forEach((member) => {
            member.addEventListener("mousemove", (e) => {
              const rect = member.getBoundingClientRect();
              const x = e.clientX - rect.left;
              const y = e.clientY - rect.top;
              const hoverEffect = member.querySelector(".hover-effect");
              hoverEffect.style.setProperty("--x", `${x}px`);
              hoverEffect.style.setProperty("--y", `${y}px`);
            });
        
            member.addEventListener("mouseleave", () => {
              const hoverEffect = member.querySelector(".hover-effect");
              hoverEffect.style.setProperty("--x", `50%`);
              hoverEffect.style.setProperty("--y", `50%`);
            });
          });
        
          document.querySelectorAll(".card").forEach((member) => {
            member.addEventListener("mousemove", (e) => {
              member.style.transition = "none";
              const rect = member.getBoundingClientRect();
              const x = -(rect.width / 2 - (e.clientX - rect.left)) / 500;
              const y = (rect.height / 2 - (e.clientY - rect.top)) / 100;
              member.style.transform = `perspective(1000px) rotateX(${y}deg) rotateY(${x}deg)`;
            });
        
            member.addEventListener("mouseleave", () => {
              member.style.transform = "none";
              member.style.transition = "transform 0.3s";
            });
          });
        </script>
      </div>
      <div class="px-36 mt-36">
        <div
          class="mb-6 w-full flex flex-row items-center justify-between gap-6"
        >
          <h2 id="team" class="font-bold text-4xl text-white">Nuestro equipo</h2>
          <Button text="Ver a todo el equipo" href="/team" />
        </div>
        <TeamJson />
      </div>
      <div id="contact" class="px-36 mt-36">
        <h2 class="font-bold text-4xl text-white mb-6">Contacto</h2>
        <div class="w-full text-white text-2xl text-semibold flex flex-col gap-8 relative">
          Te gustaría formar parte del equipo o colaborar con nosotros? No dudes en contactarnos!
          <div class="w-full flex flex-row gap-3">
            <a href="https://maps.google.com/?q=Universidad Politécnica de Valencia" class="p-3 rounded-l-xl rounded-r-md bg-white/5 hover:bg-white/10 flex items-center text-white mb-3">
              <img
                src="/img/pin.svg"
                alt="Dirección"
                class="w-8 h-8 mr-3 invert"
              />
              Camino de Vera, s/n, 46022 Valencia
            </a>
            <a href="phone:+34123456789" class="p-3 rounded-md bg-white/5 hover:bg-white/10 flex items-center text-white mb-3">
              <img
                src="/img/phone.svg"
                alt="Teléfono"
                class="w-8 h-8 mr-3 invert"
              />
              +34 123 456 789
            </a>
            <a href="mailto:contacto@tarsupv.com" class="p-3 rounded-l-md rounded-r-2xl bg-white/5 hover:bg-white/10 flex items-center text-white mb-3">
              <img
                src="/img/mail.svg"
                alt="Email"
                class="w-8 h-8 mr-3 invert"
              />
              contacto@tarsupv.com
            </a>
          </div>
        </div>
      </div>

      <Footer />
    </div>
  </main>
</Layout>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const parallaxText = document.querySelector(".parallax-text");

    window.addEventListener("scroll", () => {
      const scrollPosition = window.scrollY;
      parallaxText.style.transform = `translateY(${scrollPosition * 0.3}px) rotate(90deg)`;
    });
  });
</script>

<style>
  .hero {
    background-color: #ffffff00;
    opacity: 0.3;
    background-image: linear-gradient(#ffffff20 1px, transparent 1px),
      linear-gradient(to right, #ffffff20 1px, #ffffff00 1px);
    background-size: 40px 40px;
    mask-image: radial-gradient(circle, white 0%, transparent 70%);
    -webkit-mask-image: radial-gradient(circle, white 0%, transparent 70%);
  }
  .bg {
    background: linear-gradient(
      45deg,
      rgba(14, 14, 107, 0.3),
      rgba(209, 24, 209, 0.15),
      rgba(173, 216, 230, 0)
    );
  }
  h1 {
    font-size: 4rem;
    font-weight: 700;
    line-height: 1;
    text-align: center;
  }
  .text-gradient {
    background-image: var(--accent-gradient);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-size: 400%;
    background-position: 0%;
  }
  .more {
    height: 0;
    overflow: hidden;
    transition: height 0.3s;
  }
  .post:hover .more {
    height: 64px;
    transition: height 0.3s;
  }
  .instructions {
    margin-bottom: 2rem;
    border: 1px solid rgba(var(--accent-light), 25%);
    background: linear-gradient(
      rgba(var(--accent-dark), 66%),
      rgba(var(--accent-dark), 33%)
    );
    padding: 1.5rem;
    border-radius: 8px;
  }
  .instructions code {
    font-size: 0.8em;
    font-weight: bold;
    background: rgba(var(--accent-light), 12%);
    color: rgb(var(--accent-light));
    border-radius: 4px;
    padding: 0.3em 0.4em;
  }
  .instructions strong {
    color: rgb(var(--accent-light));
  }
  .link-card-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(24ch, 1fr));
    gap: 2rem;
    padding: 0;
  }

  .rover-image:hover {
    transform: scale(1.05);
    background-color: #101010;
  }
  .rover-image:hover .bg-tilt {
    transform: rotate(-6deg);
    opacity: 0.6;
  }
</style>
